---
phase: 06-readme-rewrite-verification
plan: 01
type: execute
wave: 1
depends_on: []
files_modified: [README.md]
autonomous: true

must_haves:
  truths:
    - "README leads with npx-based setup: paste JSON config, replace two placeholders, restart Claude Desktop"
    - "README contains tools reference table with all 10 tools"
    - "README contains troubleshooting section with 3 common issues"
    - "README contains manual install alternative (git clone fallback)"
    - "README contains user preferences section (CSV tables + Recharts charts)"
    - "README is under 200 lines total"
    - "`npx -y lightdash-mcp` starts the MCP server without crashing"
    - "All changes are committed and pushed to GitHub"
  artifacts:
    - path: "README.md"
      provides: "npx-first README for non-engineers"
      max_lines: 200
  key_links:
    - from: "README.md"
      to: "npx -y lightdash-mcp"
      via: "Claude Desktop JSON config example"
      pattern: "npx.*-y.*lightdash-mcp"
---

<objective>
Rewrite README.md for npx-first non-engineer audience and verify the end-to-end workflow.

Purpose: The current README (249 lines) was written for git clone install. Now that lightdash-mcp is published on npm, the README should lead with the simpler npx-based setup and stay under 200 lines.

Output: New README.md under 200 lines, verified npx startup, changes committed and pushed.
</objective>

<execution_context>
@/Users/mikhailgasanov/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mikhailgasanov/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@README.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Rewrite README.md with npx-first setup under 200 lines</name>
  <files>README.md</files>
  <action>
Replace the entire README.md with a new version under 200 lines. Structure it as follows:

**1. Title and one-line description** (~2 lines)
```
# Lightdash MCP Server
Give Claude Desktop read-only access to your Lightdash projects, charts, dashboards, and queries.
```

**2. Setup section — npx-first** (~40 lines)
Lead with "Setup" not "Installation". Three sub-steps:
- **Step 1: Get a Lightdash Personal Access Token** — Condensed version of current PAT instructions (click avatar > Settings > Personal Access Tokens > Generate > copy immediately). Keep it to ~8 lines.
- **Step 2: Add to Claude Desktop** — Open Settings > Developer > Edit Config. Provide ONE JSON config block (the "only MCP server" variant). Use npx command:
  ```json
  {
    "mcpServers": {
      "lightdash": {
        "command": "npx",
        "args": ["-y", "lightdash-mcp"],
        "env": {
          "LIGHTDASH_API_KEY": "your-token-here",
          "LIGHTDASH_API_URL": "https://your-lightdash-instance.com"
        }
      }
    }
  }
  ```
  Below the JSON, two bullet points explaining what to replace:
  - `your-token-here` — the token from Step 1
  - `https://your-lightdash-instance.com` — your Lightdash URL (do NOT add `/api/v1`, the server adds it automatically)
  Then: "If you already have other MCP servers, add just the `"lightdash": { ... }` block inside your existing `mcpServers` object."
- **Step 3: Restart and verify** — Quit Claude Desktop (Cmd+Q), reopen, ask Claude to "Use the lightdash_ping tool to test the connection."

**3. Available Tools table** (~15 lines)
Copy the existing 10-tool table from the current README verbatim — it's already good.

**4. Troubleshooting** (~25 lines)
Keep exactly 3 issues using `<details>` collapsible sections:
1. **"Could not connect to MCP server"** — Check that Node.js v18+ is installed (`node --version`). npx requires Node.js. Install from nodejs.org if missing.
2. **"401 Unauthorized" errors** — Token is invalid or expired. Create a new one in Lightdash Settings > Personal Access Tokens.
3. **"ECONNREFUSED" or "ENOTFOUND" errors** — URL is wrong. Don't include `/api/v1`. Use `https://` not `http://`.

**5. Manual Install (Alternative)** (~20 lines)
Section titled "Alternative: Manual Install". For users who prefer git clone:
```
git clone https://github.com/timeleft-dev/lightdash-mcp.git
cd lightdash-mcp
npm install
npm run build
```
Then use `"command": "node"` with `"args": ["/FULL/PATH/TO/lightdash-mcp/build/index.js"]` in the Claude Desktop config (same env vars).

**6. Optional: Improve Claude's Output** (~15 lines)
Keep the CSV tables and Recharts chart preferences exactly as they are in the current README.

**7. License** (~2 lines)
`MIT`

**Line count target: 170-195 lines.** Count lines after writing. If over 200, trim troubleshooting or manual install. Do NOT use HTML comments or tricks to reduce line count — actual content lines must be under 200.

**Tone:** Write for someone who has never used a terminal. Use bold for UI elements. Be direct and concise.
  </action>
  <verify>
Count the lines: `wc -l README.md` must show a number under 200.

Verify key content is present:
- `grep -c "npx" README.md` returns at least 2 (config JSON + manual mention)
- `grep "lightdash_ping" README.md` finds the tool in the table
- `grep "run_raw_query" README.md` finds the tool in the table
- `grep "Manual Install" README.md` or `grep "Alternative" README.md` finds the section
- `grep "Recharts" README.md` finds the chart preferences
- `grep "CSV" README.md` finds the CSV preferences
- `grep "401" README.md` finds troubleshooting entry
  </verify>
  <done>README.md exists at repo root, is under 200 lines, leads with npx setup, contains tools table (10 tools), troubleshooting (3 issues), manual install section, and user preferences (CSV + Recharts).</done>
</task>

<task type="auto">
  <name>Task 2: Verify npx -y lightdash-mcp starts the server</name>
  <files></files>
  <action>
Run the published package with dummy env vars to verify it starts without crashing:

```bash
timeout 5 npx -y lightdash-mcp 2>/dev/null || true
```

Set env vars LIGHTDASH_API_KEY=test and LIGHTDASH_API_URL=http://localhost:9999 so the server has values and doesn't error on missing env. The server will start as an stdio MCP server waiting for JSON-RPC input. Since there's no input, it will just sit there — the `timeout 5` ensures it exits after 5 seconds.

**Success criteria:** The process runs for the full 5 seconds without crashing (exit code 124 from timeout = success, it means the process was still running). If it crashes immediately (exit code 1), the package has an issue.

Use this exact command:
```bash
LIGHTDASH_API_KEY=test LIGHTDASH_API_URL=http://localhost:9999 timeout 5 npx -y lightdash-mcp 2>&1; echo "EXIT: $?"
```

Expected: EXIT: 124 (timeout killed it, meaning it was running fine).
  </action>
  <verify>Exit code from the timeout command is 124 (process was still running when timeout killed it) or 0 (process exited cleanly). NOT exit code 1 (crash).</verify>
  <done>`npx -y lightdash-mcp` starts and runs without crashing for 5 seconds with dummy env vars.</done>
</task>

<task type="auto">
  <name>Task 3: Git commit and push all changes</name>
  <files>README.md</files>
  <action>
Commit the updated README.md and push to origin main:

```bash
cd "/Users/mikhailgasanov/Documents/Lightdash MCP"
git add README.md
git commit -m "docs: rewrite README for npx-first install"
git push origin main
```

Only README.md should be changed. Do not commit planning files.
  </action>
  <verify>`git log --oneline -1` shows the commit message. `git status` shows clean working tree (for tracked files). `git diff origin/main..HEAD` shows no difference (push succeeded).</verify>
  <done>README.md committed and pushed to origin main on GitHub.</done>
</task>

</tasks>

<verification>
1. `wc -l README.md` < 200
2. README contains npx config JSON with `"command": "npx"` and `"args": ["-y", "lightdash-mcp"]`
3. README contains all 10 tool names in the tools table
4. README has exactly 3 troubleshooting `<details>` sections
5. README has a manual install alternative section
6. README has CSV tables and Recharts user preferences
7. `npx -y lightdash-mcp` runs without crashing (verified with timeout)
8. Changes pushed to origin main
</verification>

<success_criteria>
- README.md is under 200 lines with npx-first setup, tools table, 3-item troubleshooting, manual install, and user preferences
- `npx -y lightdash-mcp` starts successfully with dummy env vars
- All changes committed and pushed to GitHub
</success_criteria>

<output>
After completion, create `.planning/phases/06-readme-rewrite-verification/06-01-SUMMARY.md`
</output>
